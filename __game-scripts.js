var PlayerMovement=pc.createScript("playerMovement");PlayerMovement.attributes.add("camera",{type:"entity",description:"Optional, assign a camera entity, otherwise one is created"}),PlayerMovement.attributes.add("power",{type:"number",default:2500,description:"Adjusts the speed of player movement"}),PlayerMovement.attributes.add("lookSpeed",{type:"number",default:.25,description:"Adjusts the sensitivity of looking"}),PlayerMovement.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3,this.entityAbleToMove=!1,this.app.mouse.on("mousemove",this._onMouseMove,this),this.app.on("playerIsAbleToMove",function(){this.entityAbleToMove=!0}.bind(this))},PlayerMovement.prototype.update=function(e){var t=this.force,i=this.app,s=this.camera.forward,o=this.camera.right,r=0,a=0;i.keyboard.isPressed(pc.KEY_A)&&(r-=o.x,a-=o.z),i.keyboard.isPressed(pc.KEY_D)&&(r+=o.x,a+=o.z),i.keyboard.isPressed(pc.KEY_W)&&(r+=s.x,a+=s.z),i.keyboard.isPressed(pc.KEY_S)&&(r-=s.x,a-=s.z),0===r&&0===a||this.entityAbleToMove&&(t.set(r,0,a).normalize().scale(this.power),this.entity.rigidbody.applyForce(t)),this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0);const n=this.entity.findByName("Feet").getPosition(),p=pc.Vec3.DOWN.clone(),d=(new pc.Vec3).copy(n).add(p.scale(100)),y=this.app.systems.rigidbody.raycastFirst(n,d);this.distance=y?y.point.distance(n):1,this.distance>.3?(this.entity.rigidbody.applyForce(0,-20,0),this.isLanded=!1):this.isLanded=!0,this.app.keyboard.wasPressed(pc.KEY_SPACE)&&this.distance<.3&&this.entity.rigidbody.applyImpulse(0,20,0),n.y<-10&&this.entity.rigidbody.teleport(0,5,0)},PlayerMovement.prototype._onMouseMove=function(e){(pc.Mouse.isPointerLocked()||e.buttons[0]&&this.entityAbleToMove)&&(this.eulers.x-=this.lookSpeed*e.dx,this.eulers.y-=this.lookSpeed*e.dy),this.eulers.y=pc.math.clamp(this.eulers.y,-90,90)};var Camera=pc.createScript("camera");Camera.attributes.add("aimBlock",{type:"entity"}),Camera.attributes.add("boxToCopy",{type:"entity"}),Camera.attributes.add("map",{type:"entity"}),Camera.prototype.initialize=function(){},Camera.prototype.update=function(t){this.doRayCastToCenter(),this.app.mouse.wasPressed(pc.MOUSEBUTTON_LEFT)&&this.doRayCastToCenter("break"),this.app.mouse.wasPressed(pc.MOUSEBUTTON_RIGHT)&&this.doRayCastToCenter("create"),this.playerPos=this.entity.getPosition()},Camera.prototype.doRayCastToCenter=function(t){var o=this.app.graphicsDevice.width/2,i=this.app.graphicsDevice.height/2,e=this.entity.camera.screenToWorld(o,i,this.entity.camera.nearClip),s=this.entity.camera.screenToWorld(o,i,this.entity.camera.farClip),n=this.app.systems.rigidbody.raycastFirst(e,s);if(n){if("Box"==n.entity.name)if(n.point.distance(this.playerPos)<5){if(this.aimBlock.enabled=!0,this.aimBlock.setPosition(n.entity.getPosition()),"break"==t&&n.entity.destroy(),"create"==t){blockPosition=n.entity.getPosition(),lookPosition=n.point;var a=this.boxToCopy.clone();a.enabled=!0,a.name="Box",lookPosition.y>blockPosition.y+.4&&lookPosition.y<blockPosition.y+.6&&a.setLocalPosition(n.entity.getPosition().x,n.entity.getPosition().y+1,n.entity.getPosition().z),lookPosition.y<blockPosition.y-.4&&lookPosition.y>blockPosition.y-.6&&a.setLocalPosition(n.entity.getPosition().x,n.entity.getPosition().y-1,n.entity.getPosition().z),lookPosition.x>blockPosition.x+.4&&lookPosition.x<blockPosition.x+.6&&a.setLocalPosition(n.entity.getPosition().x+1,n.entity.getPosition().y,n.entity.getPosition().z),lookPosition.x<blockPosition.x-.4&&lookPosition.x>blockPosition.x-.6&&a.setLocalPosition(n.entity.getPosition().x-1,n.entity.getPosition().y,n.entity.getPosition().z),lookPosition.z>blockPosition.z+.4&&lookPosition.z<blockPosition.z+.6&&a.setLocalPosition(n.entity.getPosition().x,n.entity.getPosition().y,n.entity.getPosition().z+1),lookPosition.z<blockPosition.z-.4&&lookPosition.z>blockPosition.z-.6&&a.setLocalPosition(n.entity.getPosition().x,n.entity.getPosition().y,n.entity.getPosition().z-1),this.map.addChild(a)}}else this.aimBlock.enabled=!1}else this.aimBlock.enabled=!1};var Input=pc.createScript("input");Input.attributes.add("placeholder",{type:"string"}),Input.attributes.add("type",{type:"string",enum:[{Text:"text"},{Email:"email"},{Password:"password"}],default:"text"}),Input.attributes.add("maxLength",{type:"number",default:64}),Input.attributes.add("fontSize",{type:"number",default:1}),Input.attributes.add("padding",{type:"number",default:1}),Input.attributes.add("scaleUnit",{type:"string",enum:[{"Viewport Width":"vw"},{"Viewport Height":"vh"},{Pixel:"px"}],default:"vw"}),Input.attributes.add("color",{type:"rgb"}),Input.attributes.add("whitePlaceholder",{type:"boolean"}),Input.attributes.add("fontFamily",{type:"string",default:"Arial, sans-serif"}),Input.attributes.add("storeValue",{type:"boolean"}),Input.attributes.add("focusEntity",{type:"entity"}),Input.attributes.add("sleepValue",{type:"string"}),Input.prototype.initialize=function(){this.timeout=!1,this.lastUpdateDate=Date.now(),this.onCreate(),this.on("state",(function(t){this.entity.enabled?this.onCreate():this.onDestroy()}),this),this.app.on("DOM:Resize",this.onResize,this),this.entity.on("destroy",this.onDestroy,this)},Input.prototype.onResize=function(){this.updateStyle()},Input.prototype.onCreate=function(){this.element=document.createElement("input"),this.element.placeholder=this.placeholder,this.element.type=this.type,this.element.style.position="absolute",this.element.style.fontFamily=this.fontFamily,this.element.style.border="0px",this.element.style.background="transparent",this.element.style.fontSize=this.fontSize+this.scaleUnit,this.element.style.padding=this.padding+this.scaleUnit,this.element.style.boxSizing="border-box",this.maxLength>0&&(this.element.maxlength=this.maxLength);var t="rgb("+255*this.color.r+", "+255*this.color.g+", "+255*this.color.b+")";this.element.style.color=t,this.element.style.outline="none",this.whitePlaceholder&&(this.element.className="white-placeholder"),document.body.appendChild(this.element),this.focusEntity&&(this.focusEntity.enabled=!1,this.element.onfocus=this.onFocus.bind(this),this.element.onblur=this.onBlur.bind(this)),this.element.onchange=this.onChange.bind(this),window.localStorage.getItem(this.entity._guid)&&this.setValue(window.localStorage.getItem(this.entity._guid)),this.updateStyle(),this.sleepValue&&this.setValue(this.sleepValue),this.app.on("input:placeholder",function(t,e){t==this.entity.name&&(this.element.placeholder=e)}.bind(this)),this.app.on("input:value",function(t,e){t==this.entity.name&&(this.element.value=e)}.bind(this))},Input.prototype.onDestroy=function(){this.element&&this.element.remove(),this.app.off("DOM:Resize")},Input.prototype.store=function(){this.storeValue=!0,this.onChange()},Input.prototype.onFocus=function(){this.focusEntity.enabled=!0},Input.prototype.onBlur=function(){this.focusEntity.enabled=!1},Input.prototype.onChange=function(){this.storeValue&&window.localStorage.setItem(this.entity._guid,this.getValue())},Input.prototype.updateStyle=function(){var t=this;if(t.entity&&t.entity.element&&t.entity.element.screenCorners){var e=t.entity.element.screenCorners,n=1/t.app.graphicsDevice.maxPixelRatio;t.element.style.left=e[0].x*n+"px",t.element.style.bottom=e[0].y*n+"px",t.element.style.width=(e[2].x-e[0].x)*n+"px",t.element.style.height=(e[2].y-e[0].y)*n+"px"}},Input.prototype.setValue=function(t){this.element?(this.element.value=t,this.sleepValue=!1):this.sleepValue=t},Input.prototype.getValue=function(){if(this.element)return this.element.value},Input.prototype.getCleanValue=function(){if(this.element)return this.element.value.trim()},Input.prototype.deleteValue=function(){this.element&&(this.element.value="")},Input.prototype.isFocued=function(){return this.element&&this.focusEntity.enabled},Input.prototype.focus=function(){this.element&&this.element.focus()},Input.prototype.blur=function(){this.element&&this.element.blur()},Input.prototype.update=function(t){Date.now()-this.lastUpdateDate>1e3&&(this.updateStyle(),this.lastUpdateDate=Date.now())};var GameManager=pc.createScript("gameManager");GameManager.attributes.add("boxEntity",{type:"entity"}),GameManager.attributes.add("count",{type:"number",default:10}),GameManager.attributes.add("map",{type:"entity"}),GameManager.prototype.initialize=function(){app=this.app,this.ableToLock=!1,app.root.findByName("playButton").element.on("click",(function(t){this.app.fire("playerIsAbleToMove"),this.app.root.findByName("MenuUI").enabled=!1,this.ableToLock=!0,app.mouse.enablePointerLock(),this.nicknameVal=this.app.root.findByName("NickNameENTER").script.input.getCleanValue(),this.app.root.findByName("urNickname").element.text=this.nicknameVal}),this),app.mouse.on("mousedown",(function(){this.ableToLock&&app.mouse.enablePointerLock()}),this),this.boxEntity.enabled=!1,this.y=0;for(var t=-30;t<30;t++){for(var a=-30;a<30;a++){(e=this.boxEntity.clone()).enabled=!0,e.setPosition(t,this.y,a),this.map.addChild(e)}random=randomIntFromInterval(1,10),1==random&&(this.y-=1),10==random&&(this.y+=1)}for(a=-30;a<30;a++){for(t=-30;t<30;t++){var e;(e=this.boxEntity.clone()).enabled=!0,e.setPosition(t,this.y,a),this.map.addChild(e)}random=randomIntFromInterval(1,10),1==random&&(this.y-=1),10==random&&(this.y+=1)}function randomIntFromInterval(t,a){return Math.floor(Math.random()*(a-t+1)+t)}},GameManager.prototype.update=function(t){};